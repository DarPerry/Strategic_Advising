<!DOCTYPE html>
<html>

<head>
    <title>Strategic Advising</title>
    <link rel="stylesheet" type="text/css" href="../UI/stylesheets/search-stylesheet.css">
    <link rel="shortcut icon" href="images/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <meta charset="UTF-8">

    <script>
        //change to use jQuery
        function searchForFile(str) {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    if (this.responseText == "existingFile") {
                        $("#add-new-student").prop('disabled', true);
                        $("#txtHint").html("<p style='color:green'>Student Exisits</p>");
                        $("#add-new-student").css('background-color', "#dddddd");

                        $("#delete-student").css('background-color', "#BA0C2F");
                        $("#delete-student").prop('disabled', false);

                        $("#view-modify-student").css('background-color', "#BA0C2F");
                        $("#view-modify-student").prop('disabled', false);


                    } else if (this.responseText == "newFile" || $("#search-input").val() == "") {
                        $("#add-new-student").prop('disabled', false);
                        $("#txtHint").html("<p style='color:red'>Student Does Not Exisit</p>");
                        $("#add-new-student").css('background-color', "#BA0C2F");

                        $("#delete-student").css('background-color', "#dddddd");
                        $("#delete-student").prop('disabled', true);

                        $("#view-modify-student").css('background-color', "#dddddd");
                        $("#view-modify-student").prop('disabled', true);
                    }
                }
            };
            xmlhttp.open("GET", "fileSearch.php?email=" + str, true);
            xmlhttp.send();
        }

        $(document).ready(function() {
            document.getElementById("form").reset();

            $("#add-new-student").prop('disabled', true);
            $("#add-new-student").css('background-color', "#dddddd");

            $("#delete-student").prop('disabled', true);
            $("#delete-student").css('background-color', "#dddddd");

            $("#view-modify-student").prop('disabled', true);
            $("#view-modify-student").css('background-color', "#dddddd");





            $('#add-new-student').click(function() {
                sessionStorage.setItem("newStudentMode", "true");
                if ($('#search-input').val() !== '') { //check name field have some value
                    $.post('addNewStudent.php', {
                        'email': $('#search-input').val()
                    }, function(data) { //send value to post request in ajax to the php page
                        $('#txtHint').html(data); //print the response coming from php page 
                        sessionStorage.setItem("newStudentEmail", $('#search-input').val())
                        window.location.href = "add-modify-student.html";

                    });
                }

                // set email in student object

            });

            $("#delete-student").click(function() {
                if ($('#search-input').val() !== '') {
                    $.post('deleteStudent.php', {
                            'email': $("#search-input").val()
                        },
                        function(data) {
                            $("#txtHint").html(data);
                        });
                }
            });

            //*****//
            $("#view-modify-student").click(function() {
                sessionStorage.setItem("newStudentMode", "false");

                $.ajax({
                    url: "../students/" + $('#search-input').val() + ".sa",
                    success: function(data) {
                        sessionStorage.setItem("studentInformation", data);
                        window.location.href = "add-modify-student.html";

                    }
                });
                //                window.alert("2" + data);
                //
                //                window.alert("3" + sessionStorage.getItem("studentInformation"));

            });

        });

    </script>
</head>

<body>
    <div id="header"></div>
    <form id="form">
        <div id="body">

            <div id="search">
                Search Student: <input id="search-input" type="text" onkeyup="searchForFile(this.value)">
                <button type="button" id="add-new-student">Add New Student</button>
                <br><br>Message: <span id="txtHint">
    </form>
    </div>

    </div>
    <button id="delete-student">Delete Student</button>
    <button id="view-modify-student">View/Modify Student Schedule</button>
    <div id="footer"></div>
</body>

</html>
